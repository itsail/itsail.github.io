<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title> 8 правил хорошего тона [битрикс для начинающих]</title><meta name="description" content="Недавно обсуждали в сообществе для разработчиков, кому сколько доставалось хорошо сделанных проектов на битриксе. Результаты неутешительные — 1–2 в среднем о..."><link rel="alternate" type="application/rss+xml" title="ITSail" href="/feed.xml"><link rel="canonical" href="https://blog.itsail.ru/blog/8-rules-of-good-manners-bitrix-for-beginners/"><meta name="google-site-verification" content=""><meta name="yandex-verification" content="47167892cb6faab8" /><link href='https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans+Narrow:700&subset=latin,cyrillic' rel='stylesheet' type='text/css'><link rel="stylesheet" href="/assets/styles/main.css"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><meta property="og:url" content="https://blog.itsail.ru/blog/8-rules-of-good-manners-bitrix-for-beginners/"><meta property="og:type" content="website"><meta property="og:title" content="8 правил хорошего тона [битрикс для начинающих]"><meta property="og:description" content="Недавно обсуждали в сообществе для разработчиков, кому сколько доставалось хорошо сделанных проектов на битриксе..."><meta property="og:site_name" content="ITSail"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://blog.itsail.ru/blog/8-rules-of-good-manners-bitrix-for-beginners/"><meta name="twitter:title" content="8 правил хорошего тона [битрикс для начинающих]"><meta name="twitter:description" content="Недавно обсуждали в сообществе для разработчиков, кому сколько доставалось хорошо сделанных проектов на битриксе..."><meta property="og:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_index.jpg"><meta name="twitter:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_index.jpg"><meta property="og:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_537x240.jpg"><meta name="twitter:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_537x240.jpg"><meta property="og:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_1200x630.jpg"><meta name="twitter:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_1200x630.jpg"><meta property="og:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_1080x1080.jpg"><meta name="twitter:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_1080x1080.jpg"><meta property="og:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_1680x1680.jpg"><meta name="twitter:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_1680x1680.jpg"><meta property="og:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_1024x512.jpg"><meta name="twitter:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_1024x512.jpg"><meta property="og:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_700x500.jpg"><meta name="twitter:image" content="https://blog.itsail.ru/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_700x500.jpg"><body><div id="shadow"></div><header class="main-header content-wrapper"> <input type="checkbox" id="menu-checkbox" /><nav class="center-wrapper nav-main"> <a class="blog-logo" href="/">ITSail</a> <a href="/about/">Об этом блоге</a> <a href="/blog/">Блог</a> <a href="/feed.xml">RSS</a> <label for="menu-checkbox" class="toggle-button" data-open="☰" data-close="☰" onclick></label></nav></header><aside class="sidebar" role="note" style="background-image: url(/assets/images/2019/8_rules_of_good_manners_bitrix_for_beginners_index.jpg)"><div class="cover"><div class="cover-text"><div class="heading"> <a href="/blog/#Разработка">Разработка</a> <a href="/blog/#Битрикс">Битрикс</a></div><p>Недавно обсуждали в сообществе для разработчиков, кому сколько доставалось хорошо сделанных проектов на битриксе...</p></div></div><div id="switcher"></div></aside><main class="content-wrapper"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><h1 class="post-title" itemprop="name headline">8 правил хорошего тона [битрикс для начинающих]</h1><p class="post-meta"> <time datetime="2017-12-14">14-12-2017</time> &nbsp;/&nbsp; <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">dermanov</span> &nbsp;/&nbsp; <a itemprop="url" rel="nofollow" href="http://www.dermanov.ru/" target="_blank">Источник</a> </span> <span class="hidden" itemprop="datePublished" content="2017-12-14"></span></p><div class="post-content" itemprop="articleBody"><p>Недавно обсуждали в сообществе для разработчиков, кому сколько доставалось хорошо сделанных проектов на битриксе. Результаты неутешительные — 1–2 в среднем ответили разработчики.</p><p>Под “хорошо” подразумевается соблюдение базовых принципов разработки веб-проектов в целом и при работе с битриксом в частности. Многие [начинающие] разработчики не знают, как делать “хорошо”.</p><p>Поэтому решил подготовить краткую заметку на эту тему.</p><hr /><h2 id="1-Используйте-компоненты">1. Используйте компоненты</h2><p>Помещайте весь php-код и шаблонизацию в компоненты.</p><p>Часто можно встретить сложный php-код прямо в индексной странице раздела или любой другой. Если редактировать такую страницу через виз. редактор, то легко можно “все сломать”, и вот основные причины:</p><ul><li>виз. редактор на этапе разбора и визуализации содержимого страницы может допустить ошибки,<li>пользователь может случайно внести правки “несовместимые с жизнью” в php-код и даже не поймет этого, а все сломается.</ul><p>Так быть не должно. Любой код отвечающий за бизнес-логику приложения должен быть вынесен в собственные компоненты и модули. На страницах должны располагаться только компоненты.</p><p>Такой подход позволит:</p><ul><li>избежать проблем описанных выше,<li>снизить вероятность дублирования кода,<li>управлять заложенной логикой через настройки компонентов.</ul><h2 id="2-Храните-данные-в-кеше">2. Храните данные в кеше</h2><p>Результаты тяжелых вычислений и любых выборок из БД следует хранить в кеше.</p><p>Основные способы кеширования:</p><ul><li>файлы,<li>memcache,<li>Redis.</ul><p>Даже файлов кеш будет работать на несколько порядков быстрее, чем повторная подготовка данных. Что уж говорить про кеш в оперативной памяти.</p><p>Битрикс умеет кешировать результаты работы компонентов в файлах и в memcache. Для Redis’a можно написать свой адаптер. PHP акселераторы для этих целей не рассматриваем - пусть занимаются своей основной задачей.</p><p>В итоге место хранения кеша определяется <noindex><a href="https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=43&amp;LESSON_ID=2795" target="_blank" rel="nofollow">настройками в файле .settings.php</a></noindex>.</p><p><strong>Пример кода для работы с кешем:</strong></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Создаем объект для работы с кешем (способ кеширования задается в .settings.php)</span>
<span class="nv">$obCache</span> <span class="o">=</span> <span class="nx">Bitrix\Main\Data\Cache</span><span class="o">::</span><span class="na">createInstance</span><span class="p">();</span>

<span class="c1">// Время жизни кеша, в секундах</span>
<span class="nv">$timeout</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">;</span>

<span class="c1">// Уникальный ключ для кешированных данных</span>
<span class="c1">// на основании входных данных</span>
<span class="nv">$cacheKey</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span> <span class="nv">$arParams</span> <span class="p">);</span>

<span class="c1">// Путь относительно /bitrix/cache/</span>
<span class="c1">// Т.о. можно сбросить часть, а не весь кеш проекта.</span>
<span class="c1">// Для этого надо удалить папку /bitrix/cache/my/subdir/</span>
<span class="nv">$cacheDir</span> <span class="o">=</span> <span class="s2">"/my/subdir/"</span><span class="p">;</span>


<span class="c1">// Если кэш валиден</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$obCache</span><span class="o">-&gt;</span><span class="na">InitCache</span><span class="p">(</span> <span class="nv">$timeout</span><span class="p">,</span> <span class="nv">$cacheKey</span><span class="p">,</span> <span class="nv">$cacheDir</span> <span class="p">)</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Извлекаем данные из кэша</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$obCache</span><span class="o">-&gt;</span><span class="na">GetVars</span><span class="p">();</span>
<span class="p">}</span>
<span class="c1">// Если кэш невалиден</span>
<span class="k">elseif</span><span class="p">(</span> <span class="nv">$obCache</span><span class="o">-&gt;</span><span class="na">StartDataCache</span><span class="p">()</span>  <span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Тяжелые вычисления</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">hardWork</span><span class="p">();</span>

    <span class="c1">// Сохраняем данные в кэш</span>
    <span class="nv">$obCache</span><span class="o">-&gt;</span><span class="na">EndDataCache</span><span class="p">(</span> <span class="nv">$result</span> <span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Работаем с данными ( $result )</span>
</code></pre></div></div><h2 id="3-Используйте-модули">3. Используйте модули</h2><p>Выносите сложную бизнес-логику в модули.</p><p><strong>Модуль</strong> - это модель данных и API для доступа к этим данным. Статические методы классов модуля могут вызываться в компонентах, шаблонах, других модулях.</p><p>Модуль может состоять только из файлов с классами и не иметь интерфейса в админке или публичке. Главное, что код будет логически сгруппирован и размещен согласно логике битрикса. Модули намного легче поддерживать и расширять.</p><h2 id="4-Следите-за-оформлением-кода">4. Следите за оформлением кода</h2><p>Основные требования к оформлению кода, кстати довольно простые:</p><h3 id="Именование">Именование</h3><p>Названия переменных, констант, классов и функций - должно быть осмысленным.</p><h3 id="Выравнивание">Выравнивание</h3><p>Следите за табуляцией во вложенных блоках.</p><h3 id="Отступы">Отступы</h3><p>Разделяйте логические блоки кода одной пустой строкой.</p><h3 id="Комментарии">Комментарии</h3><p>По большому счету код должен быть самодокументируемым. Этому способоствют семантичные названия переменных, методов и тд.</p><p>Комментарии размещайте над кодом.</p><p><strong>Пример кода с комментариями:</strong></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
* Отправляем почтовые уведомления после регистрации через соц. сети,
* так как по умолчанию они не отправляются.
* В коде регистрации через соц. сети видно, что используется просто метод CUser-&gt;Add(...).
* */</span>
<span class="nx">\Bitrix\Main\EventManager</span><span class="o">::</span><span class="na">getInstance</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addEventHandler</span><span class="p">(</span>
    <span class="s2">"main"</span><span class="p">,</span>
    <span class="s2">"OnAfterUserAdd"</span><span class="p">,</span>
    <span class="s2">"socServdRegistrHandler"</span>
<span class="p">);</span>
</code></pre></div></div><p><strong>или:</strong></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Отправляем почтовые уведомления после регистрации через соц. сети,</span>
<span class="c1">// так как по умолчанию они не отправляются.</span>
<span class="c1">// В коде регистрации через соц. сети видно, что используется просто метод CUser-&gt;Add(...).</span>
<span class="nx">\Bitrix\Main\EventManager</span><span class="o">::</span><span class="na">getInstance</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addEventHandler</span><span class="p">(</span>
    <span class="s2">"main"</span><span class="p">,</span>
    <span class="s2">"OnAfterUserAdd"</span><span class="p">,</span>
    <span class="s2">"socServdRegistrHandler"</span>
<span class="p">);</span>
</code></pre></div></div><p>Однако стоит добавлять комментарии, когда логика нетривиальна. Пожалуйста, не пишите “что здесь происходит”, а пишите “почему это происходит”. Вы пишите код для людей, которые будут работать с ним после вас, представьте себя на их месте и какие вопросы у них возникнут.</p><p>Пишите комментарии к классам - какие задачи в целом решает данный класс. Пишите комментарии к методам - в стили <noindex><a href="http://omurashov.ru/docblock-in-php-documentation/" target="_blank" rel="nofollow">PhpDoc</a></noindex>, описывайте суть метода, входные и выходные параметры и тд.</p><h3 id="Вынесение-кода-в-классы-и-функции">Вынесение кода в классы и функции</h3><p>Следите за порядком в вашем коде с самого начала. Группируйте код. Используйте код повторно, но не копируйте его, а оформляйте его в виде отдельного метода и тд.</p><h3 id="Классы">Классы</h3><p>Один класс - один файл. Больше ничего не должно быть в файле с классом. Файл должен называться так же, как и класс:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// SomeClass.php</span>
<span class="k">class</span> <span class="nc">SomeClass</span> <span class="p">{</span>
  <span class="c1">// some code</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="Содержимое-файла-initphp">Содержимое файла init.php</h3><p>Не захламляйте файл init.php тоннами строк кода.</p><p>Подключайте там только “заголовочные” файлы:</p><ul><li>events.php - регистрация обработчиков событий,<li>constants.php - константы,<li>functions.php - общие функции.</ul><p><strong>Пример файла init.php:</strong></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// AddMessage2Log() будет записывать логи сюда и разбивать их по дням</span>
<span class="nb">define</span><span class="p">(</span><span class="s2">"LOG_FILENAME"</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"DOCUMENT_ROOT"</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"/_logs/bx/"</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s2">"Y_m_d"</span><span class="p">)</span> <span class="o">.</span> <span class="s2">".log"</span><span class="p">);</span>

<span class="c1">// автозагрузчик для всех классов проекта с соблюдением стандарта PSR-4</span>
<span class="nb">spl_autoload_register</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$class</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$class</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">'\\'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">,</span> <span class="nv">$class</span><span class="p">);</span>

    <span class="nv">$path</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"DOCUMENT_ROOT"</span><span class="p">]</span> <span class="o">.</span><span class="s1">'/local/lib/'</span><span class="o">.</span><span class="nv">$class</span><span class="o">.</span><span class="s1">'.php'</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">require_once</span> <span class="nv">$path</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// константы</span>
<span class="k">require_once</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"DOCUMENT_ROOT"</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"/local/php_interface/constants.php"</span><span class="p">);</span>

<span class="c1">// общие функции</span>
<span class="k">require_once</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"DOCUMENT_ROOT"</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"/local/php_interface/functions.php"</span><span class="p">);</span>

<span class="c1">// регистрация обработчиков событий</span>
<span class="k">require_once</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"DOCUMENT_ROOT"</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"/local/php_interface/events.php"</span><span class="p">);</span>
</code></pre></div></div><h3 id="Подключение-классов">Подключение классов</h3><p>Когда классов в проекте мало — можно подключить их все вручную сразу или по мере необходимости.</p><p>Когда классов в проекте много — такой подход не годится. Если подключить все сразу — будем зря забивать оперативную память кодом, который может не пригодиться. Если подключать по мере необходимости — получается слишком заморочно повсюду прописывать инклуды.</p><p>В этом случае удобнее и оптимальнее использовать автозагрузку классов.</p><p>Рассмотрим два основных способа:</p><ul><li><code class="highlighter-rouge">spl_autoload_register(...)</code> — на уровне php,<li><code class="highlighter-rouge">Loader::registerAutoLoadClasses(...)</code> — на уровне ядра битрикса.</ul><p>Между ними есть принципиальная разница в том, как они подключают файлы.</p><ul><li><code class="highlighter-rouge">registerAutoLoadClasses</code> — требует явно прописать список всех классов, которые могут быть подключены и пути к ним.<li><code class="highlighter-rouge">spl_autoload_register</code> — на основании имени класса динамически вычисляет путь где хранится файл и подключает его.</ul><h2 id="5-Следите-за-расположением-кода">5. Следите за расположением кода</h2><p>Используйте папку <code class="highlighter-rouge">local</code>. Это особенно удобно при использовании системы контроля версий. Начиная с 14 версии продукта, появилась поддержка папки <code class="highlighter-rouge">/local/</code>. В ней можно размещать весь пользовательский код проекта:</p><ul><li>шаблоны сайтов и компонентов,<li>компоненты,<li>модули,<li>и прочее.</ul><p>Для классов проекта используйте папку <code class="highlighter-rouge">/local/lib/</code>. В остальном по аналогии.</p><h2 id="6-Работайте-на-копии-проекта">6. Работайте на копии проекта</h2><p>Это общее правило для любых проектов.</p><p>Разработка на боевом сайте неизбежно связана с неработоспособностью сайта во время отладки, ошибками и иногда даже с падением сервера. Зачем рисковать своей репутацией и тратить нервы клиента - для него ошибка на сайте это конец света :) Так часто работают новички - они не знают как работать по-другому. И так работают лентяи и халтурщики - они думают, что так быстрее, но это не так.</p><p>Занимайтесь разработкой на локальной копии проекта - это очень удобно, весь проект, как на ладони. Особенно, если работать в IDE, а не в блокноте :)</p><p>Я работаю в PhpStorm, он идеально подходит для [локальной] разработки сайтов. Преимуществ очень много и трудно выделить несколько главных.</p><p><strong>Преимущества PhpStorm:</strong></p><ul><li>Подсветка синтаксиса<li>Подсказка и автозаполнение<li>Просмотр описания объектов – PhpDoc<li>Быстрый просмотр исходного кода функции<li>Переход к определению<li>Подсказка аргументов функции<li>Поиск использования функции<li>Поиск по всему проекту – то самое «умение быстро разбираться в чужом коде»<li>Навигация по открытым файлам и панелям<li>Работа с кодировками<li>Интеграция с Git<li>Построчная отладка PHP приложений<li>Поддержка TODO директив<li>Встроенный терминал<li>Логическая структура файла<li>Файловый менеджер<li>Встроенный FTP клиент<li>Публикация изменений на удаленный сервер<li>Синхронизация файлов с удаленным сервером<li>Работа с БД<li>Инструменты для рефакторинга<li>Быстрый переход к нужному файлу / папке по приблизительному пути<li>Навигация по истории контекста (переходы курсора)<li>Быстрый переход к классу / функции по имени<li>Поиск любых операций IDE по названию<li>Локальная история изменений<li>Навигация по изменным местам в файле (между коммитами)<li>Мощная система навигации по проекту<li>Закладки прямо в коде<li>Закладки файлов, можно именованными группами<li>Сворачивание произвольных участков кода<li>Сохранение / загрузка контекста<li>Интеграция с системами учета задач<li>Полноэкранный режим<li>Несколько проектов одновременно<li>Упрощенный режим для слабых компьютеров<li>Множество плагинов<li>Проверка синтаксиса, стиля кода и много чего еще<li>Навигация по открытым вкладкам через hot keys<li>Быстрый поиск всего (файлов/функций/классов) по всему проекту<li>Быстрая навигация по структуре документа<li>И еще множество крутых штук</ul><h2 id="7-Используйте-git">7. Используйте Git</h2><p>Используйте систему контроля версий (СКВ), например Git.</p><p>Много разработчиков, до сих пор, не понимают необходимость контролировать изменения в файлах с исходным кодом. А многие и вовсе не знают что такое СКВ, например Git, и как ей пользоваться.</p><p>К сожалению, СКВ решает задачу только применительно к файлам. Изменения в базе данных с помощью СКВ не отследить. На текущий момент СКВ для БД — это почти утопия.</p><p>Сейчас мы рассмотрим только основные причины для использования СКВ и настройку исключений.</p><p>Почему нужно использовать систему контроля версий:</p><ul><li>одновременная работа нескольких человек над проектом<li>возможность быстро обнаружить и откатить, все не зафиксированные изменения<li>возможность быстро откатить ошибочные, уже зафиксированные, изменения<li>история всех изменений в проекте, с указанием даты и авторов<li>возможность изучить процесс развития проекта</ul><p>Однако не все файлы следует держать под контролем, например:</p><ul><li>ядро битрикса,<li>файлы IDE,<li>временные файлы,<li>файлы не относящиеся к проекту.</ul><p>Чтобы скрыть какие-либо файлы из под бдительного ока СКВ, существует служебный файл .gitignore, в котором содержаться правила исключения.</p><p>Предлагаю вам свой образец файла .gitignore при работе с битриксом:</p><p><strong>Пример <code class="highlighter-rouge">.gitignore</code>:</strong></p><pre><code class="language-gitignore"># --- files ---
.DS_Store
Thumbs.db
/nbproject/
/.idea/
/*.sublime-project
/*.sublime-workspace

# --- core ---
/bitrix/*
!/bitrix/components
/bitrix/components/bitrix
!/bitrix/modules
/bitrix/modules/*
!/bitrix/templates
!/bitrix/php_interface
/bitrix/php_interface/after_connect.php
/bitrix/php_interface/after_connect_d7.php
/bitrix/php_interface/dbconn.php
!/bitrix/admin/
/bitrix/admin/*

# --- project modules ---
!/bitrix/modules/project*

# --- project admin scripts ---
# any project pages
!/bitrix/admin/project*
# 1c exchange custom script
!/bitrix/admin/1c_exchange_custom.php

# --- media files ---
/upload
/video
/files
/i

# --- log files ---
/_logs/
*.log
log.txt

# --- archives ---
*.tar*
*.zip*
*.rar*

# --- mysql files ---
/*.sql

# --- other ---
*.tmp
/_*
/test/
/t.php
test.php
robots.txt
sitemap*.xml
/*.txt
web.config
.htaccess.restore
*old*
*/*cache*/

cgi-bin/
google*.html
mywot*.html
wmail*.html
yandex*.html
php.ini

restore.php
bitrix_server_test.php
bitrixsetup.php

phpMyAdmin
pma
adminer.php
adminer.css

bx_1c_import.php
bx_1c_import_lite.php
/webstat

# allows fast hide any files or folders from under git's eyes
*_gitignore_*
</code></pre><h2 id="8-Завершайте-проект">8. Завершайте проект</h2><p>Завершайте работу над проектом грамотно.</p><p>Чтобы избежать случайных ошибок и проблем:</p><ul><li>пройдите еще раз “<noindex><a href="https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=35&amp;LESSON_ID=2024" target="_blank" rel="nofollow">Проверку системы</a></noindex>”,<li>сдайте проект по “<noindex><a href="https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=43&amp;CHAPTER_ID=04830" target="_blank" rel="nofollow">Монитору качества</a></noindex>”,<li>настройте <noindex><a href="https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=35&amp;LESSON_ID=4464" target="_blank" rel="nofollow">автоматическое резервное копирование</a></noindex>,<li>настройте логи.</ul><h3 id="Настройка-логов">Настройка логов</h3><p>Имея под рукой логи проще разобраться с возникшими проблемами и выяснить, когда и почему они начались.</p><p>Речь о логах функции <code class="highlighter-rouge">AddMessage2Log(...)</code> и секции <code class="highlighter-rouge">exception_handling</code> из файла <code class="highlighter-rouge">.settings.php</code>.</p><p>Чтобы в логах было удобнее ориентироваться — можно группировать их по датам. Формат даты “<code class="highlighter-rouge">Y_m_d</code>” — позволит файлам автоматически сортироваться в хронологическом порядке.</p><p>Все логи удобно держать в одном месте, например в папке <code class="highlighter-rouge">/_logs/bx/</code>.</p><p>В целях защиты следует закрыть доступ к папке с логами по <code class="highlighter-rouge">http</code> — настраивается в <code class="highlighter-rouge">.htacces</code>, и/или добавить к названию файла уникальный для проекта постфикс.</p><p>Папку для логов надо предварительно создать и убедиться, что битрикс (веб-сервер) имеет права на запись в нее.</p><p><strong>Пример настройки логов для функции <code class="highlighter-rouge">AddMessage2Log</code>:</strong></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">define</span><span class="p">(</span><span class="s2">"LOG_FILENAME"</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"DOCUMENT_ROOT"</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"/_logs/bx/"</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s2">"Y_m_d"</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"_PROJECT_UNIQUE_POSTFIX.log"</span><span class="p">);</span>
</code></pre></div></div><p><strong>Пример настройки логов для секции <code class="highlighter-rouge">exception_handling</code>:</strong></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'exception_handling'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
  <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
      <span class="s1">'debug'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// disables error output to screen</span>
       <span class="c1">// ошибки для вывода в лог</span>
      <span class="s1">'handled_errors_types'</span> <span class="o">=&gt;</span> <span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_NOTICE</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_STRICT</span> <span class="o">&amp;</span> <span class="o">~</span><span class="k">E_WARNING</span><span class="p">,</span>
      <span class="s1">'exception_errors_types'</span> <span class="o">=&gt;</span> <span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_NOTICE</span> <span class="o">&amp;</span> <span class="o">~</span><span class="k">E_WARNING</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_STRICT</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_COMPILE_WARNING</span><span class="p">,</span>
      <span class="s1">'ignore_silence'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">'assertion_throws_exception'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">'assertion_error_type'</span> <span class="o">=&gt;</span> <span class="mi">256</span><span class="p">,</span>
      <span class="s1">'log'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
          <span class="s1">'settings'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
              <span class="s1">'file'</span> <span class="o">=&gt;</span> <span class="s2">"_logs/bx_error/"</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s2">"Y_m_d"</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"_PROJECT_UNIQUE_POSTFIX.log"</span><span class="p">,</span>
              <span class="s1">'log_size'</span> <span class="o">=&gt;</span> <span class="mi">1000000</span><span class="p">,</span> <span class="c1">// ~ 1Mb per file</span>
          <span class="p">),</span>
      <span class="p">),</span>
  <span class="p">),</span>
  <span class="s1">'readonly'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">),</span>
</code></pre></div></div><h2 id="Подведем-итоги">Подведем итоги</h2><p>Я постарался собрать основные правила хорошего тона, о которых следует знать начинающим разработчикам, и не забывать опытным. Я уверен, что соблюдение этих правил поднимет качество, как при повседневной работе проекта, так и при его модернизации.</p><p>Надеюсь теперь сайтов на битриксе, которые будут сделаны “хорошо”, будут работать быстро и легко поддерживаться станет больше.</p><a class="link-to-post" href="/blog/5-ways-to-increase-instagram-audience/"> <span class="link-to-post__next">&#10535; &nbsp;Следующая запись</span> <span class="link-to-post__title">5 способов увеличения аудитории Instagram</span> </a></div></article></main><footer class="blog-footer content-wrapper"><p>&copy; <span class="full-year"></span> ITSail</p></footer><script src="/assets/scripts/scripts.min.js"></script> <script type="text/javascript" > (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)}) (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(52279162, "init", { id:52279162, clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true, trackHash:true }); </script> <noscript><div><img src="https://mc.yandex.ru/watch/52279162" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
